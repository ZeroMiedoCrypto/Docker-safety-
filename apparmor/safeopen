# AppArmor profile for safeopen container
profile safeopen flags=(attach_disconnected,mediate_deleted) {
  network,
  capability,
  file,

  deny network inet6,
  deny network raw,

  capability chown,
  capability dac_override,
  capability dac_read_search,
  capability fowner,
  capability fsetid,
  capability kill,
  capability setgid,
  capability setuid,
  capability setpcap,
  capability linux_immutable,
  capability net_bind_service,
  capability net_admin,
  capability net_raw,
  capability sys_module,
  capability sys_rawio,
  capability sys_chroot,
  capability sys_pacct,
  capability sys_admin,
  capability sys_boot,
  capability sys_nice,
  capability sys_resource,
  capability sys_time,
  capability sys_tty_config,
  capability mknod,
  capability audit_write,
  capability audit_control,
  capability mac_override,
  capability mac_admin,
  capability syslog,
  capability wake_alarm,
  capability block_suspend,
  capability audit_read,

  file,
  deny @{PROC}/sysrq-trigger w,
  deny @{PROC}/kcore r,
  deny mount,
  deny /proc/sysrq-trigger rwklx,
  deny /sys/[^/]*/** rwklx,
  deny /sys/kernel/security/** rwklx,
  deny /sys/kernel/debug/** rwklx,
  deny /sys/firmware/efi/efivars/** rwklx,
  deny /etc/shadow r,
  deny /etc/shadow- r,
  deny /root/** rwklx,

  /usr/bin/chromium rix,
  /usr/bin/clam* rix,
  /usr/bin/tigervncserver rix,
  /usr/bin/fluxbox rix,
  /usr/bin/dbus-launch rix,
  /usr/bin/xset rix,
  /usr/bin/xsetroot rix,
  /usr/bin/xrdb rix,
  /usr/bin/vncpasswd rix,
  /usr/bin/sha256sum rix,
  /usr/bin/openssl rix,

  /usr/lib/** r,
  /usr/share/** r,
  /etc/** r,
  owner /home/safeuser/** rw,
  /tmp/** rw,
  /run/** rw,
  /var/log/** rw,
}
